<!DOCTYPE html>
<!--
Javascript jQuery Three.js 360VR test. With help from...
http://www.html5rocks.com/en/tutorials/device/orientation/
-->
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<link rel="icon" type="image/png" href="./icon_vr.png" />
		<link rel="apple-touch-icon" href="./icon_vr.png">
		<title>Three.js 360VR Demo</title>
		<meta name="apple-touch-fullscreen" content="yes">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
		<script src="https://ajax.googleapis.com/ajax/libs/threejs/r76/three.min.js"></script>
		<script type="text/javascript">
			window.onload = function() {

					var renderer = new THREE.WebGLRenderer();
					renderer.setSize( 800, 600 );
					document.getElementById("threecanvas").appendChild( renderer.domElement );

					var scene = new THREE.Scene();

					var camera = new THREE.PerspectiveCamera(
							35,             // Field of view
							800 / 600,      // Aspect ratio
							0.1,            // Near plane
							10000           // Far plane
					);
					camera.position.set( 0, 0, 30 );
					camera.lookAt( scene.position );

					var geometry = new THREE.BoxGeometry( 5, 5, 5 );
					var material = new THREE.MeshPhongMaterial( { color: 0xFF0000 } );
					var mesh = new THREE.Mesh( geometry, material );
					scene.add( mesh );

					var light = new THREE.PointLight( 0xFFFFFF );
					light.position.set( 10, 40, 20 );
					scene.add( light );

					var light = new THREE.PointLight( 0x888800 );
					light.position.set( -10, -40, 20 );
					scene.add( light );

					renderer.setClearColor( 0xdddddd, 1);
					renderer.render( scene, camera );

					function deviceOrientationHandler(tiltLR, tiltFB, dir) {
						document.getElementById("doTiltLR").innerHTML = Math.round(tiltLR);
						document.getElementById("doTiltFB").innerHTML = Math.round(tiltFB);
						document.getElementById("doDirection").innerHTML = Math.round(dir);
						// Apply the transform to the image
						mesh.rotateX(tiltLR);
						mesh.rotateY(tiltFB);
						mesh.rotateZ(dir);
						renderer.render(scene, camera);
						requestAnimationFrame(render);
					}

					if (window.DeviceOrientationEvent) {
					  document.getElementById("doEvent").innerHTML = "DeviceOrientation";
					  // Listen for the deviceorientation event and handle the raw data
					  window.addEventListener('deviceorientation', function(eventData) {
					    // in landscape orientation, gamma is front/back, beta is the 'tilt' left/right
					    var tiltFB = eventData.gamma;
					    var tiltLR = eventData.beta;
					    var dir = eventData.alpha
					    deviceOrientationHandler(tiltLR, tiltFB, dir);
					  }, false);
					} else {
					  document.getElementById("doEvent").innerHTML = "Not supported."
					}


			};
		</script>
		<style>
		@media screen {
			html, body, div, span {
				margin: 0;
			  padding: 0;
			  border: 0;
			  outline: 0;
			  font-size: 100%;
			  vertical-align: baseline;
			}

			body {
				height: auto;
		  	-webkit-text-size-adjust:none;
		  	font-family:Helvetica, Arial, Verdana, sans-serif;
		  	padding:0px;
				overflow-x: hidden;
			}

		}
		</style>
	</head>
	<body>
		<div class="main">
		  <h2>Device Orientation</h2>
		  <table>
		    <tr>
		      <td>Event Supported</td>
		      <td id="doEvent"></td>
		    </tr>
		    <tr>
		      <td>Tilt Left/Right [gamma]</td>
		      <td id="doTiltLR"></td>
		    </tr>
		    <tr>
		      <td>Tilt Front/Back [beta]</td>
		      <td id="doTiltFB"></td>
		    </tr>
		    <tr>
		      <td>Direction [alpha]</td>
		      <td id="doDirection"></td>
		    </tr>
		   </table>
		</div>
		<div id="threecanvas"></div>
	</body>
	<script type="text/javascript">

	</script>
</html>
